<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reinforcement Learning Demos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Combined styles */
        @keyframes pulse {
            0% { background-color: #fee2e2; }
            50% { background-color: #fca5a5; }
            100% { background-color: #fee2e2; }
        }
        .stuck {
            animation: pulse 1.5s infinite;
        }
        .agent-move {
            transition: all 0.5s ease-in-out;
        }
        .policy-card {
            transition: all 0.3s ease;
        }
        .policy-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .grid-cell {
            transition: background-color 0.3s ease;
        }
        .bad-goal {
            background-color: #ef4444;
            color: white;
        }
        .code-font {
            font-family: monospace;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
        }
        .soft-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
        }
        .hard-shadow {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .transition-smooth {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .animate-pulse {
            animation: pulse 0.5s ease-in-out;
        }
        .gradient-text {
            background: linear-gradient(90deg, #4f46e5 0%, #7c3aed 50%, #a855f7 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        /* Navigation styles */
        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            overflow: hidden;
            margin-bottom: 2rem;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        .nav-tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #6b7280;
            background: #f9fafb;
            border-bottom: 3px solid transparent;
        }
        .nav-tab:hover {
            background: #f3f4f6;
            color: #4f46e5;
        }
        .nav-tab.active {
            background: white;
            color: #4f46e5;
            border-bottom: 3px solid #4f46e5;
        }
        .nav-tab i {
            margin-right: 8px;
        }
        
        /* Demo containers */
        .demo-container {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        .demo-container.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Improved responsiveness for policy gradient demo */
        .article-card {
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }
        .article-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .article-card.selected {
            box-shadow: 0 0 0 3px #4f46e5;
        }
        .article-card.processing {
            opacity: 0.7;
            cursor: not-allowed;
        }
        .reward-indicator {
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .reward-content {
            transition: opacity 0.3s ease;
        }
        .reward-processing {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white py-8 px-4">
        <div class="max-w-6xl mx-auto text-center">
            <h1 class="text-4xl font-bold mb-4">Reinforcement Learning Demos</h1>
            <p class="text-xl text-indigo-100 max-w-3xl mx-auto">
                Interactive demonstrations of key reinforcement learning concepts
            </p>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <div class="max-w-6xl mx-auto px-4 py-6">
        <div class="nav-tabs">
            <div class="nav-tab active" data-demo="demo1">
                <i class="fas fa-chess-board"></i>
                Aliased Grid World
            </div>
            <div class="nav-tab" data-demo="demo2">
                <i class="fas fa-chart-line"></i>
                Policy Gradient
            </div>
        </div>
    </div>

    <!-- Demo 1: Aliased Grid World -->
    <div id="demo1" class="demo-container active">
        <div class="container mx-auto px-4 py-8 max-w-6xl">
            <!-- Header -->
            <header class="text-center mb-12">
                <h1 class="text-4xl font-bold text-indigo-800 mb-3">Stochastic Policy in Aliased Grid World</h1>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto">
                    Explore how stochastic policies can solve problems that deterministic policies struggle with in partially observable environments.
                </p>
            </header>

            <!-- Main Content -->
            <main>
                <!-- Policy Cards Container -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
                    <!-- Deterministic (Left) Policy -->
                    <div class="policy-card bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100">
                        <div class="p-6">
                            <div class="flex items-center mb-4">
                                <div class="bg-blue-100 p-2 rounded-lg mr-3">
                                    <i class="fas fa-arrow-right text-blue-600 text-xl"></i>
                                </div>
                                <h3 class="text-xl font-semibold text-gray-800">Deterministic (→ from left)</h3>
                            </div>
                            
                            <div class="grid grid-cols-5 gap-1 mb-6 mx-auto w-fit grid-placeholder">
                                <!-- Grid will be rendered here by JavaScript -->
                            </div>
                            
                            <div class="flex space-x-3 mb-4">
                                <button class="run-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex-1 transition flex items-center justify-center">
                                    <i class="fas fa-play mr-2"></i> Run Policy
                                </button>
                                <button class="reset-btn bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-lg transition">
                                    <i class="fas fa-redo"></i>
                                </button>
                            </div>
                            
                            <div class="result text-center py-2 rounded-lg mb-4"></div>
                            
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <p class="text-sm text-gray-700">
                                    <i class="fas fa-info-circle text-blue-500 mr-1"></i> 
                                    In aliased (gray) states, this deterministic policy always moves right (→ →).
                                    Works well when starting from the left, but would get stuck if starting from the right.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Deterministic (Right) Policy -->
                    <div class="policy-card bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100">
                        <div class="p-6">
                            <div class="flex items-center mb-4">
                                <div class="bg-red-100 p-2 rounded-lg mr-3">
                                    <i class="fas fa-arrow-right text-red-600 text-xl"></i>
                                </div>
                                <h3 class="text-xl font-semibold text-gray-800">Deterministic (→ from right)</h3>
                            </div>
                            
                            <div class="grid grid-cols-5 gap-1 mb-6 mx-auto w-fit grid-placeholder">
                                <!-- Grid will be rendered here by JavaScript -->
                            </div>
                            
                            <div class="flex space-x-3 mb-4">
                                <button class="run-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex-1 transition flex items-center justify-center">
                                    <i class="fas fa-play mr-2"></i> Run Policy
                                </button>
                                <button class="reset-btn bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-lg transition">
                                    <i class="fas fa-redo"></i>
                                </button>
                            </div>
                            
                            <div class="result text-center py-2 rounded-lg mb-4"></div>
                            
                            <div class="bg-red-50 p-4 rounded-lg">
                                <p class="text-sm text-gray-700">
                                    <i class="fas fa-info-circle text-red-500 mr-1"></i> 
                                    In aliased (gray) states, this deterministic policy always moves right (→ →).
                                    Gets stuck in an aliased loop when starting from the right position.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Stochastic Policy -->
                    <div class="policy-card bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100">
                        <div class="p-6">
                            <div class="flex items-center mb-4">
                                <div class="bg-purple-100 p-2 rounded-lg mr-3">
                                    <i class="fas fa-random text-purple-600 text-xl"></i>
                                </div>
                                <h3 class="text-xl font-semibold text-gray-800">Stochastic (50/50 in gray)</h3>
                            </div>
                            
                            <div class="grid grid-cols-5 gap-1 mb-6 mx-auto w-fit grid-placeholder">
                                <!-- Grid will be rendered here by JavaScript -->
                            </div>
                            
                            <div class="flex space-x-3 mb-4">
                                <button class="run-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex-1 transition flex items-center justify-center">
                                    <i class="fas fa-play mr-2"></i> Run Policy
                                </button>
                                <button class="reset-btn bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-lg transition">
                                    <i class="fas fa-redo"></i>
                                </button>
                            </div>
                            
                            <div class="result text-center py-2 rounded-lg mb-4"></div>
                            
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <p class="text-sm text-gray-700 mb-2">
                                    <i class="fas fa-info-circle text-purple-500 mr-1"></i> 
                                    Optimal solution: Randomizes actions in aliased states.
                                </p>
                                <ul class="text-xs space-y-1">
                                    <li class="flex items-start">
                                        <i class="fas fa-dot-circle text-purple-400 mt-1 mr-2 text-xs"></i>
                                        <span>π(right | walls above/below) = 0.5</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-dot-circle text-purple-400 mt-1 mr-2 text-xs"></i>
                                        <span>π(left | walls above/below) = 0.5</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-dot-circle text-purple-400 mt-1 mr-2 text-xs"></i>
                                        <span>Avoids getting stuck and eventually reaches the treasure.</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Explanation Section -->
                <div class="bg-white rounded-xl shadow-md p-6 mb-8 border border-gray-100">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-lightbulb text-yellow-500 mr-3"></i>
                        Understanding the Problem
                    </h2>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h3 class="font-semibold text-gray-700 mb-2 flex items-center">
                                <i class="fas fa-question-circle text-blue-500 mr-2"></i>
                                What is an Aliased State?
                            </h3>
                            <p class="text-gray-600 text-sm">
                                Aliased states are perceptually identical states that require different optimal actions.
                                In this grid world, the gray cells are aliased - they look the same to the agent but require
                                different movements to reach the treasure depending on their actual position.
                            </p>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-700 mb-2 flex items-center">
                                <i class="fas fa-chart-line text-green-500 mr-2"></i>
                                Why Stochastic Policies Work
                            </h3>
                            <p class="text-gray-600 text-sm">
                                Deterministic policies can get stuck in infinite loops in aliased environments.
                                By introducing randomness (stochastic policy), the agent can eventually escape
                                these loops and find the optimal path to the treasure.
                            </p>
                        </div>
                    </div>
                </div>
            </main>
            
            <!-- Footer -->
            <footer class="text-center text-gray-500 text-sm mt-12">
                <p>Interactive demonstration of stochastic policies in reinforcement learning</p>
            </footer>
        </div>
    </div>

    <!-- Demo 2: Policy Gradient -->
    <div id="demo2" class="demo-container">
        <div class="max-w-7xl mx-auto px-4 py-8">
            <div class="text-center mb-12">
                <h1 class="text-4xl font-bold text-indigo-800 mb-3">Policy Gradient Explained</h1>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto">
                    Interactive demonstration of reinforcement learning with policy gradients
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left Panel - Simulation -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden transition-smooth hover:hard-shadow">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                                <i class="fas fa-robot mr-2 text-indigo-500"></i>
                                Recommendation Engine
                            </h2>
                            <div class="flex items-center space-x-2">
                                <span class="px-2 py-1 bg-indigo-100 text-indigo-800 rounded-md text-xs font-medium">
                                    <i class="fas fa-bolt mr-1"></i> Interactive
                                </span>
                            </div>
                        </div>
                        
                        <!-- User Profile Card -->
                        <div class="bg-gradient-to-r from-indigo-50 to-blue-50 rounded-lg p-5 mb-6 border border-indigo-100">
                            <div class="flex items-start justify-between">
                                <div>
                                    <h3 id="user-type" class="text-lg font-semibold text-gray-800">User Profile: Teenager</h3>
                                    <p id="user-description" class="text-gray-600 text-sm mt-1">Age 13-19, interested in games and social media</p>
                                </div>
                                <div class="flex-shrink-0">
                                    <div class="h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center">
                                        <i class="fas fa-user text-indigo-500"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <div class="flex justify-between text-sm text-gray-600 mb-1">
                                    <span>Learning Progress</span>
                                    <span id="trials-count">0</span> trials
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2.5">
                                    <div id="learning-progress" class="bg-indigo-600 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Task Explanation -->
                        <div class="bg-blue-50 border-l-4 border-blue-400 rounded-r-lg p-4 mb-6">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-info-circle text-blue-500"></i>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-blue-800">Current Task</h3>
                                    <div class="mt-1 text-sm text-blue-700">
                                        <p>A recommendation algorithm learning which articles to show different user types.</p>
                                        <p class="mt-1">Each article shown is an <span class="font-bold bg-yellow-100 px-1 rounded">action (A)</span>, each user is a <span class="font-bold bg-yellow-100 px-1 rounded">state (S)</span>, and each click is a <span class="font-bold bg-yellow-100 px-1 rounded">reward (R)</span>.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Articles Container -->
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                            <i class="fas fa-newspaper mr-2 text-indigo-500"></i>
                            Available Articles
                        </h3>
                        <p class="text-gray-600 text-sm mb-4">Click an article to show it to the user and update the policy:</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6" id="ad-container">
                            <!-- Articles will be inserted here by JavaScript -->
                        </div>
                        
                        <!-- Reward Indicator - Improved with persistent display -->
                        <div id="reward-indicator" class="reward-indicator rounded-lg p-4 mb-6 text-center font-medium">
                            <!-- Content will be inserted here by JavaScript -->
                        </div>
                        
                        <!-- Policy Update Details -->
                        <div id="update-details" class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg p-5 border border-purple-200 mb-6">
                            <h3 class="text-lg font-semibold text-purple-800 mb-3 flex items-center">
                                <i class="fas fa-calculator mr-2 text-purple-500"></i>
                                Policy Update Details
                            </h3>
                            <div class="text-sm text-gray-700">
                                <p>When you select an article, we:</p>
                                <ol class="list-decimal pl-5 mt-2 space-y-1">
                                    <li>Calculate ∇<sub>θ</sub>logπ(A|S) - how to change θ to make this action more likely</li>
                                    <li>Multiply by the reward R (1 for click, 0 for no click)</li>
                                    <li>Update θ in this direction: θ ← θ + α∇<sub>θ</sub>logπ(A|S)R</li>
                                </ol>
                                <p class="mt-2">Click an article to see the specific calculations.</p>
                            </div>
                        </div>
                        
                        <!-- Controls -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                            <button id="next-user" class="bg-indigo-100 hover:bg-indigo-200 text-indigo-800 font-medium py-2 px-4 rounded-lg transition-smooth flex items-center justify-center">
                                <i class="fas fa-user-friends mr-2"></i> Next User
                            </button>
                            <button id="auto-run" class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-lg transition-smooth flex items-center justify-center">
                                <i class="fas fa-play mr-2"></i> Auto Run (20)
                            </button>
                            <button id="reset" class="bg-red-100 hover:bg-red-200 text-red-800 font-medium py-2 px-4 rounded-lg transition-smooth flex items-center justify-center">
                                <i class="fas fa-redo mr-2"></i> Reset
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Right Panel - Learning Process -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden transition-smooth hover:hard-shadow">
                    <div class="p-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-brain mr-2 text-indigo-500"></i>
                            Learning Process
                        </h2>
                        
                        <!-- Formula Container -->
                        <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-5 mb-6 border border-indigo-100">
                            <div class="text-center p-4 bg-white rounded-md shadow-inner">
                                <div class="text-2xl font-bold gradient-text">
                                    ∇<sub>θ</sub>J(θ) = 𝔼[∇<sub>θ</sub>logπ(A|S) R(S,A)]
                                </div>
                            </div>
                            <p class="mt-3 text-sm text-gray-600 text-center">
                                This identity tells us how to update our policy parameters θ to maximize expected rewards by increasing the probability of actions that led to good outcomes.
                            </p>
                        </div>
                        
                        <!-- Policy Table -->
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                            <i class="fas fa-table mr-2 text-indigo-500"></i>
                            Current Policy Probabilities π(A|S)
                        </h3>
                        
                        <div class="overflow-x-auto mb-6">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User Type</th>
                                        <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Gaming</th>
                                        <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Sports</th>
                                        <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Finance</th>
                                    </tr>
                                </thead>
                                <tbody id="policy-table-body" class="bg-white divide-y divide-gray-200">
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Policy Update Explanation -->
                        <div class="bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-5 mb-6 border border-green-200">
                            <h3 class="text-lg font-semibold text-green-800 mb-3 flex items-center">
                                <i class="fas fa-lightbulb mr-2 text-green-500"></i>
                                Understanding the Policy Update
                            </h3>
                            <div class="text-sm text-gray-700 space-y-3">
                                <div>
                                    <p class="font-medium text-green-700">When user clicks (R=1):</p>
                                    <div class="code-font bg-white p-2 rounded-md text-sm mt-1 border border-green-200">
                                        θ ← θ + α∇<sub>θ</sub>logπ(A|S)
                                    </div>
                                    <p class="mt-1">We increase the probability of showing this article to similar users.</p>
                                </div>
                                
                                <div>
                                    <p class="font-medium text-green-700">When user doesn't click (R=0):</p>
                                    <div class="code-font bg-white p-2 rounded-md text-sm mt-1 border border-green-200">
                                        θ ← θ + α∇<sub>θ</sub>logπ(A|S)·0 = θ
                                    </div>
                                    <p class="mt-1">No update occurs because we got no signal about this action's quality.</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Learning Log -->
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                            <i class="fas fa-scroll mr-2 text-indigo-500"></i>
                            Learning Log
                        </h3>
                        
                        <div id="log-container" class="bg-gray-50 rounded-lg p-4 h-64 overflow-y-auto custom-scrollbar border border-gray-200">
                            <div class="text-sm text-gray-600">
                                <div class="mb-2 pb-2 border-b border-gray-200">
                                    <div class="text-xs text-gray-500 mb-1">[System]</div>
                                    <div>Welcome! Click an article to begin seeing how policy gradients work.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-gray-100 border-t border-gray-200 py-6 mt-12">
        <div class="max-w-6xl mx-auto px-4 text-center text-gray-500 text-sm">
            <p>Interactive Reinforcement Learning Demos | Built with HTML, CSS & JavaScript</p>
            <p class="mt-1">© 2023 RL Explorer</p>
        </div>
    </footer>

    <script>
        // Navigation functionality
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Update navigation
                document.querySelectorAll('.nav-tab').forEach(t => {
                    t.classList.remove('active');
                });
                this.classList.add('active');
                
                // Show selected demo
                const demoId = this.getAttribute('data-demo');
                document.querySelectorAll('.demo-container').forEach(container => {
                    container.classList.remove('active');
                });
                document.getElementById(demoId).classList.add('active');
            });
        });

        // =====================
        // DEMO 1: Aliased Grid World
        // =====================
        // Custom grid configuration
        const gridConfig = [
            // Top row (row 0)
            ['S', 'A', 'M', 'A', 'S'],
            // Bottom row (row 1)
            ['B', '', 'T', '', 'B']  // B = Bad goal, '' = completely empty space
        ];
        
        // Policy types
        const POLICY_TYPES = {
            DET_LEFT: 'det-left',
            DET_RIGHT: 'det-right',
            STOCHASTIC: 'stochastic'
        };
        
        // Game states
        const states = {
            [POLICY_TYPES.DET_LEFT]: { 
                pos: [0, 0], // Start at left white block
                running: false, 
                policy: 'right',
                gridElement: document.querySelectorAll('.policy-card')[0].querySelector('.grid-placeholder'),
                resultEl: document.querySelectorAll('.policy-card')[0].querySelector('.result'),
                runBtn: document.querySelectorAll('.policy-card')[0].querySelector('.run-btn'),
                resetBtn: document.querySelectorAll('.policy-card')[0].querySelector('.reset-btn')
            },
            [POLICY_TYPES.DET_RIGHT]: { 
                pos: [0, 4], // Start at right white block
                running: false, 
                policy: 'right',
                gridElement: document.querySelectorAll('.policy-card')[1].querySelector('.grid-placeholder'),
                resultEl: document.querySelectorAll('.policy-card')[1].querySelector('.result'),
                runBtn: document.querySelectorAll('.policy-card')[1].querySelector('.run-btn'),
                resetBtn: document.querySelectorAll('.policy-card')[1].querySelector('.reset-btn')
            },
            [POLICY_TYPES.STOCHASTIC]: { 
                pos: [0, 0], // Start at left white block
                running: false,
                gridElement: document.querySelectorAll('.policy-card')[2].querySelector('.grid-placeholder'),
                resultEl: document.querySelectorAll('.policy-card')[2].querySelector('.result'),
                runBtn: document.querySelectorAll('.policy-card')[2].querySelector('.run-btn'),
                resetBtn: document.querySelectorAll('.policy-card')[2].querySelector('.reset-btn')
            }
        };
        
        function cellExists(row, col) {
            const val = gridConfig[row][col];
            return val !== 'X' && val !== undefined;
        }
        
        function isBadGoal(row, col) {
            return gridConfig[row][col] === 'B';
        }
        
        function isAliased(row, col) {
            return gridConfig[row][col] === 'A';
        }
        
        function isMiddle(row, col) {
            return gridConfig[row][col] === 'M';
        }
        
        function isStart(row, col) {
            return gridConfig[row][col] === 'S';
        }
        
        function isTreasure(row, col) {
            return gridConfig[row][col] === 'T';
        }
        
        function renderGrids() {
            Object.keys(states).forEach(type => {
                renderGrid(type);
            });
        }
        
        function renderGrid(type) {
            const state = states[type];
            state.gridElement.innerHTML = '';
            state.gridElement.classList.add('grid', 'grid-cols-5', 'gap-1', 'mb-6', 'mx-auto', 'w-fit');
            
            for (let row = 0; row < 2; row++) {
                for (let col = 0; col < 5; col++) {
                    if (!cellExists(row, col)) continue;
                    
                    const cell = document.createElement('div');
                    // Hide completely empty cells (empty string in config)
                    const isEmpty = gridConfig[row][col] === '';
                    cell.className = `grid-cell w-12 h-14 ${isEmpty ? 'invisible' : 'border border-gray-200 rounded flex items-center justify-center relative'}`;
                    
                    if (isTreasure(row, col)) {
                        cell.className += ' bg-yellow-100';
                        cell.innerHTML = '<i class="fas fa-gem text-yellow-500 text-xl"></i>';
                    } else if (isAliased(row, col)) {
                        cell.className += ' bg-gray-200';
                        
                        if (type === POLICY_TYPES.DET_LEFT || type === POLICY_TYPES.DET_RIGHT) {
                            cell.innerHTML += '<i class="fas fa-arrow-right text-red-500 absolute right-1"></i>';
                        } else {
                            cell.innerHTML += `
                                <i class="fas fa-arrow-left text-purple-500 absolute left-1"></i>
                                <i class="fas fa-arrow-right text-purple-500 absolute right-1"></i>
                            `;
                        }
                    } else if (isMiddle(row, col)) {
                        cell.innerHTML += '<i class="fas fa-arrow-down text-blue-500 absolute bottom-1"></i>';
                    } else if (isBadGoal(row, col)) {
                        cell.className += ' bad-goal';
                        cell.innerHTML = '<i class="fas fa-skull text-white text-xl"></i>';
                        cell.title = "Bad goal state - avoid!";
                    } else if (isStart(row, col)) {
                        cell.className += ' bg-white';
                    }
                    
                    state.gridElement.appendChild(cell);
                }
            }
            
            updateAgentPosition(type);
        }
        
        function updateAgentPosition(type) {
            const state = states[type];
            // Remove any existing agent
            state.gridElement.querySelectorAll('.agent').forEach(el => el.remove());
            // Remove stuck class from all cells
            state.gridElement.querySelectorAll('.grid-cell').forEach(cell => {
                cell.classList.remove('stuck');
            });
            
            const [row, col] = state.pos;
            const cells = state.gridElement.querySelectorAll('.grid-cell');
            
            let index = 0;
            for (let r = 0; r < 2; r++) {
                for (let c = 0; c < 5; c++) {
                    if (!cellExists(r, c)) continue;
                    if (r === row && c === col) {
                        const agent = document.createElement('div');
                        agent.className = 'agent absolute w-9 h-9 bg-green-500 text-white rounded-full flex items-center justify-center text-lg agent-move';
                        agent.innerHTML = '<i class="fas fa-robot"></i>';
                        cells[index].appendChild(agent);
                        cells[index].classList.add('relative');
                        
                        if (state.stuck) {
                            cells[index].classList.add('stuck');
                        }
                        return;
                    }
                    index++;
                }
            }
        }
        
        function moveAgent(type) {
            const state = states[type];
            if (!state.running) return;
            
            const [row, col] = state.pos;
            
            if (isTreasure(row, col)) {
                state.resultEl.innerHTML = '<span class="text-green-600"><i class="fas fa-check-circle mr-1"></i> Found treasure!</span>';
                state.resultEl.className = "result bg-green-50 py-2 rounded-lg mb-4";
                state.running = false;
                state.runBtn.innerHTML = '<i class="fas fa-play mr-2"></i> Run Policy';
                state.runBtn.classList.remove('bg-blue-700');
                state.runBtn.classList.add('bg-blue-600');
                return;
            }
            
            if (isBadGoal(row, col)) {
                state.resultEl.innerHTML = '<span class="text-red-600"><i class="fas fa-skull mr-1"></i> Hit bad goal state!</span>';
                state.resultEl.className = "result bg-red-50 py-2 rounded-lg mb-4";
                state.running = false;
                state.runBtn.innerHTML = '<i class="fas fa-play mr-2"></i> Run Policy';
                state.runBtn.classList.remove('bg-blue-700');
                state.runBtn.classList.add('bg-blue-600');
                return;
            }
            
            const moves = [];
            
            if (col < 4 && cellExists(row, col + 1) && !isBadGoal(row, col + 1)) {
                moves.push([0, 1]);
            }
            if (col > 0 && cellExists(row, col - 1) && !isBadGoal(row, col - 1)) {
                moves.push([0, -1]);
            }
            if (row === 0 && cellExists(1, col) && !isBadGoal(1, col)) {
                moves.push([1, 0]);
            }
            if (row === 1 && cellExists(0, col) && !isBadGoal(0, col)) {
                moves.push([-1, 0]);
            }
            
            if (moves.length > 0) {
                let move;
                
                if (isMiddle(row, col)) {
                    // Always move down from middle
                    move = moves.find(m => m[0] === 1) || moves[0];
                }
                else if (isAliased(row, col)) {
                    if (type === POLICY_TYPES.DET_LEFT || type === POLICY_TYPES.DET_RIGHT) {
                        // Always prefer right in aliased states
                        move = moves.find(m => m[1] === 1) || moves[0];
                    } else {
                        // Stochastic policy
                        const possibleMoves = moves.filter(m => m[1] !== 0);
                        if (possibleMoves.length > 0) {
                            move = possibleMoves[Math.floor(Math.random() * possibleMoves.length)];
                        } else {
                            move = moves[Math.floor(Math.random() * moves.length)];
                        }
                    }
                } else {
                    if (type === POLICY_TYPES.DET_LEFT || type === POLICY_TYPES.DET_RIGHT) {
                        // Prefer right, then down, then left
                        move = moves.find(m => m[1] === 1) || 
                               moves.find(m => m[0] === 1) || 
                               moves.find(m => m[1] === -1) || 
                               moves[0];
                    } else {
                        // Stochastic policy
                        move = moves[Math.floor(Math.random() * moves.length)];
                    }
                }
                
                const [dr, dc] = move;
                state.pos = [row + dr, col + dc];
                
                if ((type === POLICY_TYPES.DET_LEFT || type === POLICY_TYPES.DET_RIGHT) && isAliased(row, col)) {
                    const [newRow, newCol] = state.pos;
                    if (isAliased(newRow, newCol) && type === POLICY_TYPES.DET_RIGHT) {
                        // Only the right-starting agent gets stuck
                        state.stuck = true;
                        state.resultEl.innerHTML = '<span class="text-red-600"><i class="fas fa-exclamation-circle mr-1"></i> Stuck in aliased loop!</span>';
                        state.resultEl.className = "result bg-red-50 py-2 rounded-lg mb-4";
                        state.running = false;
                        state.runBtn.innerHTML = '<i class="fas fa-play mr-2"></i> Run Policy';
                        state.runBtn.classList.remove('bg-blue-700');
                        state.runBtn.classList.add('bg-blue-600');
                    }
                }
                
                updateAgentPosition(type);
            }
            
            if (state.running) {
                setTimeout(() => moveAgent(type), 600);
            }
        }
        
        function resetAgent(type) {
            const state = states[type];
            // Reset to starting positions
            if (type === POLICY_TYPES.DET_RIGHT) state.pos = [0, 4];
            else if (type === POLICY_TYPES.DET_LEFT) state.pos = [0, 0];
            else state.pos = [0, 0];
            state.running = false;
            state.stuck = false;
            state.resultEl.innerHTML = "";
            state.resultEl.className = "result py-2 rounded-lg mb-4";
            state.runBtn.innerHTML = '<i class="fas fa-play mr-2"></i> Run Policy';
            state.runBtn.classList.remove('bg-blue-700');
            state.runBtn.classList.add('bg-blue-600');
            updateAgentPosition(type);
        }
        
        function initDemo1() {
            renderGrids();
            
            // Set up event listeners for each policy type
            Object.keys(states).forEach(type => {
                const state = states[type];
                
                state.runBtn.addEventListener('click', () => {
                    if (!state.running) {
                        resetAgent(type);
                        state.running = true;
                        state.runBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Running...';
                        state.runBtn.classList.remove('bg-blue-600');
                        state.runBtn.classList.add('bg-blue-700');
                        moveAgent(type);
                    }
                });
                
                state.resetBtn.addEventListener('click', () => {
                    resetAgent(type);
                });
            });
        }
        
        // Initialize Demo 1
        initDemo1();

        // =====================
        // DEMO 2: Policy Gradient (with improved reward display)
        // =====================
        // User types (states) and their descriptions
        const userTypes = [
            { 
                id: 0,
                name: "Teenager", 
                description: "Age 13-19, interested in games and social media",
                rewards: [0.8, 0.3, 0.1], // Probability of click for each article
                icon: "fas fa-gamepad"
            },
            { 
                id: 1,
                name: "Young Adult", 
                description: "Age 20-35, interested in tech and sports",
                rewards: [0.4, 0.7, 0.2],
                icon: "fas fa-running"
            },
            { 
                id: 2,
                name: "Middle Aged", 
                description: "Age 36-55, interested in finance and news",
                rewards: [0.1, 0.3, 0.9],
                icon: "fas fa-chart-line"
            }
        ];
        
        // Articles (actions)
        const articles = [
            { 
                id: 0, 
                name: "Gaming News", 
                shortName: "Gaming", 
                description: "New game releases this week",
                icon: "fas fa-gamepad",
                color: "bg-green-100 text-green-800 border-green-200"
            },
            { 
                id: 1, 
                name: "Sports Update", 
                shortName: "Sports", 
                description: "Latest football match results",
                icon: "fas fa-running",
                color: "bg-blue-100 text-blue-800 border-blue-200"
            },
            { 
                id: 2, 
                name: "Market Trends", 
                shortName: "Finance", 
                description: "Stock market trends analysis",
                icon: "fas fa-chart-line",
                color: "bg-purple-100 text-purple-800 border-purple-200"
            }
        ];
        
        // Policy parameters (θ) - one set per user type
        let policyParams = [
            [1.0, 1.0, 1.0], // Teenager
            [1.0, 1.0, 1.0], // Young Adult
            [1.0, 1.0, 1.0]  // Middle Aged
        ];
        
        // Current state
        let currentUserType = 0;
        let currentArticleSelected = null;
        let currentReward = 0;
        let trialsCount = 0;
        let autoRunInterval = null;
        
        // DOM elements
        const userTypeEl = document.getElementById('user-type');
        const userDescriptionEl = document.getElementById('user-description');
        const adContainerEl = document.getElementById('ad-container');
        const rewardIndicatorEl = document.getElementById('reward-indicator');
        const logContainerEl = document.getElementById('log-container');
        const policyTableBodyEl = document.getElementById('policy-table-body');
        const nextUserBtn = document.getElementById('next-user');
        const autoRunBtn = document.getElementById('auto-run');
        const resetBtn = document.getElementById('reset');
        const trialsCountEl = document.getElementById('trials-count');
        const learningProgressEl = document.getElementById('learning-progress');
        const updateDetailsEl = document.getElementById('update-details');
        
        // Learning rate
        const learningRate = 0.3;
        
        // Initialize the demo
        function initDemo2() {
            renderUser();
            renderArticles();
            renderPolicyTable();
            clearRewardIndicator();
            
            // Set up event listeners
            nextUserBtn.addEventListener('click', nextUser);
            autoRunBtn.addEventListener('click', toggleAutoRun);
            resetBtn.addEventListener('click', resetPolicy);
        }
        
        // Clear reward indicator
        function clearRewardIndicator() {
            rewardIndicatorEl.innerHTML = '';
            rewardIndicatorEl.className = 'reward-indicator rounded-lg p-4 mb-6 text-center font-medium';
        }
        
        // Render current user
        function renderUser() {
            const user = userTypes[currentUserType];
            userTypeEl.textContent = `User Profile: ${user.name}`;
            userDescriptionEl.textContent = user.description;
            trialsCountEl.textContent = trialsCount;
            
            const progressPercent = Math.min(100, trialsCount);
            learningProgressEl.style.width = `${progressPercent}%`;
        }
        
        // Render article options
        function renderArticles() {
            adContainerEl.innerHTML = '';
            
            // Get policy probabilities for current user type
            const probs = getPolicyProbabilities(currentUserType);
            
            articles.forEach((article, index) => {
                const articleEl = document.createElement('div');
                articleEl.className = `article-card rounded-lg border p-4 cursor-pointer flex flex-col items-center ${article.color}`;
                
                articleEl.innerHTML = `
                    <div class="h-10 w-10 rounded-full ${article.color.replace('bg-', 'bg-opacity-50 bg-')} flex items-center justify-center mb-3">
                        <i class="${article.icon}"></i>
                    </div>
                    <h4 class="font-semibold text-center mb-1">${article.name}</h4>
                    <p class="text-xs text-center mb-2">${article.description}</p>
                    <div class="w-full bg-white bg-opacity-50 rounded-full h-1.5 mt-2">
                        <div class="h-1.5 rounded-full ${article.color.replace('bg-', 'bg-')}" style="width: ${probs[index] * 100}%"></div>
                    </div>
                    <span class="text-xs font-medium mt-1">${(probs[index] * 100).toFixed(1)}% chance</span>
                `;
                
                articleEl.dataset.articleId = index;
                articleEl.addEventListener('click', () => selectArticle(index));
                adContainerEl.appendChild(articleEl);
            });
        }
        
        // Select an article (action) - IMPROVED with stable reward display
        function selectArticle(articleId) {
            // Clear previous selection
            document.querySelectorAll('[data-article-id]').forEach(el => {
                el.classList.remove('selected');
                el.classList.add('processing');
            });
            
            // Set new selection immediately
            currentArticleSelected = articleId;
            const articleEl = document.querySelector(`[data-article-id="${articleId}"]`);
            articleEl.classList.add('selected');
            
            // Show processing state in reward indicator
            rewardIndicatorEl.innerHTML = `
                <div class="reward-processing">
                    <i class="fas fa-spinner fa-spin text-indigo-500 text-2xl mb-2"></i>
                    <p>Processing recommendation...</p>
                </div>
            `;
            
            // Simulate reward (click or not) after a short delay
            setTimeout(() => {
                const clickProbability = userTypes[currentUserType].rewards[articleId];
                currentReward = Math.random() < clickProbability ? 1 : 0;
                
                // Show reward
                if (currentReward === 1) {
                    rewardIndicatorEl.innerHTML = `
                        <div class="reward-content animate-pulse">
                            <div class="bg-green-100 text-green-800 rounded-lg p-4">
                                <i class="fas fa-check-circle mr-2"></i>
                                Article Clicked! (Reward = +1)
                            </div>
                        </div>
                    `;
                } else {
                    rewardIndicatorEl.innerHTML = `
                        <div class="reward-content animate-pulse">
                            <div class="bg-red-100 text-red-800 rounded-lg p-4">
                                <i class="fas fa-times-circle mr-2"></i>
                                Article Ignored (Reward = 0)
                            </div>
                        </div>
                    `;
                }
                
                logMessage(`Showed ${articles[articleId].name} to ${userTypes[currentUserType].name}`);
                logMessage(`User ${currentReward === 1 ? 'CLICKED' : 'ignored'} the article (R = ${currentReward})`);
                
                // Update policy
                updatePolicy();
                
                // Increment trial count
                trialsCount++;
                renderUser();
                
                // Re-enable article cards
                document.querySelectorAll('[data-article-id]').forEach(el => {
                    el.classList.remove('processing');
                });
            }, 600);
        }
        
        // Update policy using policy gradient
        function updatePolicy() {
            if (currentArticleSelected === null) return;
            
            const userType = currentUserType;
            const action = currentArticleSelected;
            const reward = currentReward;
            
            // Get current probabilities
            const probs = getPolicyProbabilities(userType);
            
            // Compute gradient of log policy
            const gradLogPolicy = [];
            for (let a = 0; a < articles.length; a++) {
                if (a === action) {
                    gradLogPolicy.push(1 - probs[a]); // For selected action
                } else {
                    gradLogPolicy.push(-probs[a]);    // For other actions
                }
            }
            
            // Update parameters (θ += α * ∇logπ * R)
            for (let a = 0; a < articles.length; a++) {
                policyParams[userType][a] += learningRate * gradLogPolicy[a] * reward;
            }
            
            // Log the gradient calculation
            logMessage(`Computing gradient ∇logπ(A|S):`);
            logMessage(`For chosen action ${articles[action].shortName}: 1 - π(${articles[action].shortName}|S) = ${(1 - probs[action]).toFixed(3)}`);
            for (let a = 0; a < articles.length; a++) {
                if (a !== action) {
                    logMessage(`For ${articles[a].shortName}: -π(${articles[a].shortName}|S) = ${(-probs[a]).toFixed(3)}`);
                }
            }
            
            // Re-render
            renderArticles();
            renderPolicyTable();
        }
        
        // Get policy probabilities for a user type (softmax)
        function getPolicyProbabilities(userType) {
            const params = policyParams[userType];
            const maxParam = Math.max(...params);
            const exps = params.map(x => Math.exp(x - maxParam)); // Numerically stable
            const sumExps = exps.reduce((a, b) => a + b, 0);
            return exps.map(x => x / sumExps);
        }
        
        // Render policy table
        function renderPolicyTable() {
            policyTableBodyEl.innerHTML = '';
            
            userTypes.forEach((user, userType) => {
                const row = document.createElement('tr');
                row.className = userType === currentUserType ? 'bg-indigo-50' : '';
                
                // User type
                const userCell = document.createElement('td');
                userCell.className = 'px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 flex items-center';
                userCell.innerHTML = `
                    <i class="${user.icon} mr-2 text-indigo-500"></i>
                    ${user.name}
                `;
                row.appendChild(userCell);
                
                // Article probabilities
                const probs = getPolicyProbabilities(userType);
                probs.forEach((prob, i) => {
                    const probCell = document.createElement('td');
                    probCell.className = 'px-4 py-3 whitespace-nowrap';
                    
                    // Create a visual bar for probability
                    const barContainer = document.createElement('div');
                    barContainer.className = 'flex items-center';
                    
                    const barOuter = document.createElement('div');
                    barOuter.className = 'w-full bg-gray-200 rounded-full h-2.5 mr-2';
                    
                    const bar = document.createElement('div');
                    bar.className = `h-2.5 rounded-full ${articles[i].color.replace('bg-', 'bg-')}`;
                    bar.style.width = `${prob * 100}%`;
                    bar.style.transition = 'width 0.3s';
                    
                    const label = document.createElement('span');
                    label.className = 'text-xs font-medium text-gray-500';
                    label.textContent = `${(prob * 100).toFixed(1)}%`;
                    
                    barOuter.appendChild(bar);
                    barContainer.appendChild(barOuter);
                    barContainer.appendChild(label);
                    probCell.appendChild(barContainer);
                    row.appendChild(probCell);
                });
                
                policyTableBodyEl.appendChild(row);
            });
        }
        
        // Move to next user
        function nextUser() {
            currentUserType = (currentUserType + 1) % userTypes.length;
            currentArticleSelected = null;
            clearRewardIndicator();
            renderUser();
            renderArticles();
            renderPolicyTable();
            logMessage(`Switched to new user type: ${userTypes[currentUserType].name}`);
        }
        
        // Toggle auto-run
        function toggleAutoRun() {
            if (autoRunInterval) {
                clearInterval(autoRunInterval);
                autoRunInterval = null;
                autoRunBtn.innerHTML = '<i class="fas fa-play mr-2"></i> Auto Run (20)';
                autoRunBtn.classList.remove('bg-indigo-700');
                autoRunBtn.classList.add('bg-indigo-600');
                logMessage("Stopped auto-run");
            } else {
                let trialsRemaining = 20;
                autoRunBtn.innerHTML = '<i class="fas fa-stop mr-2"></i> Stop Auto Run';
                autoRunBtn.classList.remove('bg-indigo-600');
                autoRunBtn.classList.add('bg-indigo-700');
                logMessage(`Starting auto-run for ${trialsRemaining} trials...`);
                
                autoRunInterval = setInterval(() => {
                    if (trialsRemaining <= 0) {
                        clearInterval(autoRunInterval);
                        autoRunInterval = null;
                        autoRunBtn.innerHTML = '<i class="fas fa-play mr-2"></i> Auto Run (20)';
                        autoRunBtn.classList.remove('bg-indigo-700');
                        autoRunBtn.classList.add('bg-indigo-600');
                        logMessage("Auto-run completed");
                        return;
                    }
                    
                    // Randomly select an article according to current policy
                    const probs = getPolicyProbabilities(currentUserType);
                    const randomVal = Math.random();
                    let cumulativeProb = 0;
                    let selectedArticle = 0;
                    
                    for (let i = 0; i < probs.length; i++) {
                        cumulativeProb += probs[i];
                        if (randomVal <= cumulativeProb) {
                            selectedArticle = i;
                            break;
                        }
                    }
                    
                    selectArticle(selectedArticle);
                    trialsRemaining--;
                    
                    // Switch user occasionally
                    if (Math.random() < 0.3) {
                        nextUser();
                    }
                }, 1000);
            }
        }
        
        // Reset policy
        function resetPolicy() {
            policyParams = [
                [1.0, 1.0, 1.0],
                [1.0, 1.0, 1.0],
                [1.0, 1.0, 1.0]
            ];
            trialsCount = 0;
            currentUserType = 0;
            currentArticleSelected = null;
            currentReward = 0;
            clearRewardIndicator();
            
            if (autoRunInterval) {
                clearInterval(autoRunInterval);
                autoRunInterval = null;
                autoRunBtn.innerHTML = '<i class="fas fa-play mr-2"></i> Auto Run (20)';
                autoRunBtn.classList.remove('bg-indigo-700');
                autoRunBtn.classList.add('bg-indigo-600');
            }
            
            renderUser();
            renderArticles();
            renderPolicyTable();
            logMessage("Policy reset to initial state");
        }
        
        // Add message to log
        function logMessage(message) {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            
            const logEntry = document.createElement('div');
            logEntry.className = 'mb-2 pb-2 border-b border-gray-200';
            logEntry.innerHTML = `
                <div class="text-xs text-gray-500 mb-1">[${timeString}]</div>
                <div class="text-sm">${message}</div>
            `;
            
            logContainerEl.appendChild(logEntry);
            logContainerEl.scrollTop = logContainerEl.scrollHeight;
        }
        
        // Initialize Demo 2
        initDemo2();
    </script>
</body>
</html>
